(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"userAuthorized",(function(){return Ne})),n.d(r,"getUserProfileInfo",(function(){return ke})),n.d(r,"authCodeObtained",(function(){return Ce})),n.d(r,"getAccessToken",(function(){return we})),n.d(r,"getRefreshToken",(function(){return Pe}));var a={};n.r(a),n.d(a,"getUserTopData",(function(){return Be})),n.d(a,"userInputSelected",(function(){return Ge})),n.d(a,"testAction",(function(){return Fe}));var c={};n.r(c),n.d(c,"toggleLoading",(function(){return He}));var o,s=n(0),u=n.n(s),i=n(24),l=n.n(i),p=(n(71),n(52)),d=n.n(p),T=n(34),O=n.n(T),E=n(20),f=E.c,_=n.p+"static/media/Spotify_Logo_RGB_White.f48fb565.png",h=n(54),b=n.n(h),g=n(4),j=function(e){return e.show?Object(g.jsx)("div",{className:b.a.Backdrop,children:e.children}):null},S=n(55),y=n.n(S),m=function(){return Object(g.jsx)("div",{id:"Loader",className:y.a.Loader,children:"Loading..."})},v=n(15),x=(n(32),n(11));function A(e){return{REQUEST:"".concat(e,".REQUEST"),SUCCESS:"".concat(e,".SUCCESS"),FAILURE:"".concat(e,".FAILURE")}}!function(e){e.USER_AUTHORIZED="USER_AUTHORIZED",e.USER_PROFILE_INFO_OBTAINED="USER_PROFILE_INFO_OBTAINED",e.AUTH_CODE_OBTAINED="AUTH_CODE_OBTAINED",e.ACCESS_TOKEN_OBTAINED="ACCESS_TOKEN_OBTAINED",e.REFRESH_TOKEN_OBTAINED="REFRESH_TOKEN_OBTAINED",e.USER_TOP_DATA_OBTAINED="USER_TOP_DATA_OBTAINED",e.USER_INPUT_SELECTED="USER_INPUT_SELECTED",e.TOGGLE_LOADING="TOGGLE_LOADING",e.ERROR="ERROR"}(o||(o={}));var I={POST_TEST:A("POST_TEST"),PUT_TEST:A("PUT_TEST"),GET_TEST:A("GET_TEST"),DELETE_TEST:A("DELETE_TEST")},R={loading:!1},U={userTopData:[],userInputSelect:{type:"artists",timeTerm:"long_term"}},D={isLoggedIn:!1,userProfileInfo:{},authCode:"",accessToken:"",refreshToken:""},L={error:null},N=Object(v.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.USER_AUTHORIZED:return Object(x.a)(Object(x.a)({},e),{},{isLoggedIn:t.payload.isLoggedIn,accessToken:t.payload.accessToken,refreshToken:t.payload.refreshToken});case o.USER_PROFILE_INFO_OBTAINED:return Object(x.a)(Object(x.a)({},e),{},{userProfileInfo:Object(x.a)({},t.payload)});case o.AUTH_CODE_OBTAINED:return Object(x.a)(Object(x.a)({},e),{},{authCode:t.payload});case o.ACCESS_TOKEN_OBTAINED:return Object(x.a)(Object(x.a)({},e),{},{accessToken:t.payload});case o.REFRESH_TOKEN_OBTAINED:return Object(x.a)(Object(x.a)({},e),{},{refreshToken:t.payload});case I.POST_TEST.REQUEST:return console.log("aca se mando.. #esperando"),e;case I.POST_TEST.SUCCESS:return console.log("aca anduvo.."),e;case I.POST_TEST.FAILURE:return console.log("aca fall\xf3.."),e;default:return e}},userData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.USER_INPUT_SELECTED:return Object(x.a)(Object(x.a)({},e),{},{userInputSelect:t.payload});case o.USER_TOP_DATA_OBTAINED:return Object(x.a)(Object(x.a)({},e),{},{userTopData:t.payload});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.TOGGLE_LOADING:return{loading:t.payload};default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.ERROR:return{error:t.payload};default:return e}}}),k=n(64),C=n(56),w=n(5),P=n.n(w),B=n(8),G=n(22),F=n(57),H=n.n(F),Q=function(){var e=Object(G.a)(P.a.mark((function e(){var t,n,r,a,c,o,s=arguments;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"aca pones ej /song/isjd1941",n=s.length>1?s[1]:void 0,r=s.length>2&&void 0!==s[2]?s[2]:"aca metes la url de spotify","GET"===(a=K(n)).method&&a.params&&(t+=H.a.stringify(a.params,{addQueryPrefix:!0})),c="".concat(r,"/api/").concat(t),e.next=8,fetch(c,a);case 8:if((o=e.sent).ok){e.next=11;break}throw new Error(o.statusText);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function K(e){var t=e.body,n="[object Object]"===Object.prototype.toString.call(t),r=n?{"Content-Type":"application/json"}:{},a=n?{body:JSON.stringify(t)}:{};return Object.assign({},e,{headers:r},a)}function z(e){return Q("/auth/google-token",{method:"POST",body:e})}function J(e){return Q("/auth/refresh-token",{method:"PUT",body:e})}function q(){return Q("/auth/refresh-token",{method:"DELETE"})}function Z(e){return Q("/mock?user=".concat(e.email),{method:"GET"})}var M=P.a.mark(re),V=P.a.mark(ae),W=P.a.mark(ce),X=P.a.mark(oe),Y=P.a.mark(se),$=P.a.mark(ue),ee=P.a.mark(ie),te=P.a.mark(le),ne=P.a.mark(pe);function re(e){var t,n;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t=e.body,console.log("[SAGA]: Request"),r.next=5,Object(B.b)(z,t);case 5:return n=r.sent,console.log("[SAGA]: Success"),r.next=9,Object(B.d)({type:I.POST_TEST.SUCCESS,payload:n});case 9:r.next=16;break;case 11:return r.prev=11,r.t0=r.catch(0),console.log("[SAGA]: Failure"),r.next=16,Object(B.d)({type:I.POST_TEST.FAILURE,message:r.t0.message||r.t0});case 16:case"end":return r.stop()}}),M,null,[[0,11]])}function ae(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.e)(I.POST_TEST.REQUEST,re);case 2:case"end":return e.stop()}}),V)}function ce(e){var t;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(B.b)(Z,e.body);case 3:return t=n.sent,n.next=6,Object(B.d)({type:I.GET_TEST.SUCCESS,payload:t});case 6:n.next=12;break;case 8:return n.prev=8,n.t0=n.catch(0),n.next=12,Object(B.d)({type:I.GET_TEST.FAILURE,message:n.t0.message||n.t0});case 12:case"end":return n.stop()}}),W,null,[[0,8]])}function oe(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.e)(I.GET_TEST.REQUEST,ce);case 2:case"end":return e.stop()}}),X)}function se(e){var t,n;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t=e.body,r.next=4,Object(B.b)(q,t);case 4:return n=r.sent,r.next=7,Object(B.d)({type:I.DELETE_TEST.SUCCESS,payload:n});case 7:r.next=13;break;case 9:return r.prev=9,r.t0=r.catch(0),r.next=13,Object(B.d)({type:I.DELETE_TEST.FAILURE,message:r.t0.message||r.t0});case 13:case"end":return r.stop()}}),Y,null,[[0,9]])}function ue(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.e)(I.DELETE_TEST.REQUEST,se);case 2:case"end":return e.stop()}}),$)}function ie(e){var t;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(B.b)(J,e.body);case 3:return t=n.sent,n.next=6,Object(B.d)({type:I.PUT_TEST.SUCCESS,payload:t});case 6:n.next=12;break;case 8:return n.prev=8,n.t0=n.catch(0),n.next=12,Object(B.d)({type:I.PUT_TEST.FAILURE,message:n.t0.message||n.t0});case 12:case"end":return n.stop()}}),ee,null,[[0,8]])}function le(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.e)(I.PUT_TEST.REQUEST,ie);case 2:case"end":return e.stop()}}),te)}function pe(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.a)([Object(B.c)(ae),Object(B.c)(oe),Object(B.c)(ue),Object(B.c)(le)]);case 2:case"end":return e.stop()}}),ne)}var de=P.a.mark(Te);function Te(){var e;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[pe].map(B.c),t.next=3,Object(B.a)(e);case 3:case"end":return t.stop()}}),de)}var Oe=Te,Ee=Object(k.a)(),fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||v.d,_e=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return void console.log(t)}}(),he=Object(v.e)(N,_e,fe(Object(v.a)(C.a),Object(v.a)(Ee)));he.subscribe((function(){return function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){console.log(n)}}(he.getState())})),Ee.run(Oe);var be=n(26),ge=n.n(be),je=he.getState();he.subscribe((function(){je=he.getState(),Re.set("code",je.login.authCode)}));var Se="https://accounts.spotify.com/api/token",ye="https://joaquinconti.github.io/spotify-app/",me="https://api.spotify.com/v1",ve="790a84d7acf74bb19d1190baa107e089",xe="user-read-private user-read-email user-read-recently-played user-read-playback-state user-top-read user-modify-playback-state user-read-currently-playing",Ae="https://accounts.spotify.com/authorize?response_type=code&client_id="+ve+"&scope="+encodeURIComponent(xe)+"&redirect_uri="+encodeURIComponent(ye),Ie=btoa("".concat(ve,":").concat("06abc79902244fc5b6428a26ed6df6e6")),Re=new URLSearchParams;Re.append("grant_type","authorization_code"),Re.append("redirect_uri",ye),Re.append("code",je.login.authCode);var Ue,De=he.getState();he.subscribe((function(){De=he.getState(),Ue={headers:{Authorization:"Bearer ".concat(De.login.accessToken)}}}));var Le={headers:{Authorization:"Basic ".concat(Ie),"Content-Type":"application/x-www-form-urlencoded"}},Ne=function(e){var t={isLoggedIn:!0};return e||(t={isLoggedIn:!1,accessToken:"",refreshToken:""}),{type:o.USER_AUTHORIZED,payload:t}},ke=function(){return function(){var e=Object(G.a)(P.a.mark((function e(t){var n,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ge.a.get("".concat(me,"/me"),Ue);case 3:n=e.sent,r=n.data,console.log(r),t({type:o.USER_PROFILE_INFO_OBTAINED,payload:r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.response);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},Ce=function(e){return{type:o.AUTH_CODE_OBTAINED,payload:e}},we=function(){return function(){var e=Object(G.a)(P.a.mark((function e(t){var n,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Access Token] fetching"),e.prev=1,e.next=4,ge.a.post(Se,Re,Le);case 4:n=e.sent,r=n.data,t({type:o.ACCESS_TOKEN_OBTAINED,payload:r.access_token}),t({type:o.REFRESH_TOKEN_OBTAINED,payload:r.refreshToken}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0.response);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()},Pe=function(){return function(){var e=Object(G.a)(P.a.mark((function e(t){var n,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[RefreshToken Token] fetching"),e.prev=1,e.next=4,ge.a.post(Se,Re,Le);case 4:n=e.sent,r=n.data,console.log(r),t({type:o.ACCESS_TOKEN_OBTAINED,payload:r.access_token}),t({type:o.REFRESH_TOKEN_OBTAINED,payload:r.refresh_token}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0.response);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},Be=function(e){var t=e.type,n=e.timeTerm;return function(){var r=Object(G.a)(P.a.mark((function r(a){var c,s;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a({type:o.ERROR,payload:null}),console.log("[getUserTopData]",e),a({type:o.TOGGLE_LOADING,payload:!0}),r.prev=3,a({type:o.USER_TOP_DATA_OBTAINED,payload:[]}),console.log("[getUserTopData] fetching"),r.next=8,ge.a.get("".concat(me,"/me/top/").concat(t,"?time_range=").concat(n),Ue);case 8:c=r.sent,s=c.data,console.log("[ActionCreator]",s),a({type:o.USER_TOP_DATA_OBTAINED,payload:s.items}),a({type:o.TOGGLE_LOADING,payload:!1}),r.next=20;break;case 15:r.prev=15,r.t0=r.catch(3),a({type:o.TOGGLE_LOADING,payload:!1}),console.log(r.t0.response),a({type:o.ERROR,payload:"Something went wrong. Try re-logging in."});case 20:case"end":return r.stop()}}),r,null,[[3,15]])})));return function(e){return r.apply(this,arguments)}}()},Ge=function(e){return function(){var t=Object(G.a)(P.a.mark((function t(n){return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:o.ERROR,payload:null}),n({type:o.USER_TOP_DATA_OBTAINED,payload:[]});try{n({type:o.USER_INPUT_SELECTED,payload:e})}catch(r){console.log(r.response),n({type:o.ERROR,payload:"Something went wrong. Try re-logging in."})}case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Fe=function(){return{type:I.POST_TEST.REQUEST}},He=function(e){return{type:o.TOGGLE_LOADING,payload:e}},Qe=function(){var e=Object(E.b)();return Object(v.b)(r,e)},Ke=function(e){var t={code:""},n=document.createElement("a");n.href=e;for(var r=n.search.substring(1).split("&"),a=0;a<r.length;a++){var c=r[a].split("=");t[c[0]]=decodeURIComponent(c[1])}return t},ze=n(63),Je=n(117),qe=n(116),Ze=n(114),Me=n(118),Ve=n(115),We=n(35),Xe=n.n(We),Ye=function(){var e=f((function(e){return e.userData})),t=e.userTopData,n=e.userInputSelect;return Object(g.jsx)(u.a.Fragment,{children:Object(g.jsx)(Ze.a,{cols:2,cellHeight:300,spacing:1,className:Xe.a.GridList,children:t&&t.map((function(e,t){return Object(g.jsxs)(Me.a,{cols:0===t?2:1,rows:1,children:[Object(g.jsx)("img",{className:Xe.a.ArtistImage,src:"artists"===n.type?e.images[0].url:e.album.images[0].url,alt:e.name}),Object(g.jsx)(Ve.a,{title:"".concat(t+1,". ").concat(e.name),titlePosition:"top",actionPosition:"left",className:Xe.a.TitleBar})]},t)}))})})},$e=n(30),et=n.n($e),tt=function(){var e=Object(s.useState)(!1),t=Object(ze.a)(e,2),n=(t[0],t[1],f((function(e){return e.userData}))),r=n.userInputSelect,c=n.userTopData,o=f((function(e){return e.login})),i=o.accessToken,l=o.userProfileInfo,p=function(){var e=Object(E.b)();return Object(v.b)(a,e)}(),d=p.getUserTopData,T=p.userInputSelected,O=Qe(),_=O.getUserProfileInfo,h=O.userAuthorized,b=l.display_name,j=l.images,S=function(e,t){T({type:"type"===t?e.target.value:r.type,timeTerm:"timeTerm"===t?e.target.value:r.timeTerm})};return Object(s.useEffect)((function(){console.log(r.type),i&&(_(),d(r))}),[i,r]),c.length?Object(g.jsxs)(u.a.Fragment,{children:[Object(g.jsx)("h4",{children:b}),Object(g.jsx)(Je.a,{className:et.a.UserImage,src:j[0].url,alt:"".concat(b," image")}),Object(g.jsx)(qe.a,{variant:"contained",onClick:function(){return h(!1)},children:"Log Out"}),Object(g.jsxs)("div",{className:et.a.GroupDiv,children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"typeSelect",children:"Get your top: "}),Object(g.jsxs)("select",{value:r.type,className:et.a.Select,name:"type",onChange:function(e){return S(e,e.target.name)},children:[Object(g.jsx)("option",{value:"artists",children:"Artists"}),Object(g.jsx)("option",{value:"tracks",children:"Tracks"})]})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"timeTermSelect",children:"From: "}),Object(g.jsxs)("select",{value:r.timeTerm,className:et.a.Select,name:"timeTerm",onChange:function(e){return S(e,e.target.name)},children:[Object(g.jsx)("option",{value:"short_term",children:"This month"}),Object(g.jsx)("option",{value:"medium_term",children:"6 months"}),Object(g.jsx)("option",{value:"long_term",children:"All time"})]})]})]}),Object(g.jsx)(Ye,{})]}):null},nt=function(){var e=f((function(e){return e.login})),t=e.authCode,n=e.isLoggedIn,r=f((function(e){return e.ui})).loading,a=f((function(e){return e.error})).error,c=Qe(),o=c.userAuthorized,i=c.authCodeObtained,l=c.getAccessToken;Object(E.b)();return Object(s.useEffect)((function(){var e=Ke(window.location.href).code;e&&e!==t&&(i(e),l(),o(!0))}),[]),Object(g.jsxs)("main",{className:O.a.Container,children:[Object(g.jsx)("img",{className:O.a.Logo,src:_,alt:"spotify-logo"}),n?Object(g.jsxs)(u.a.Fragment,{children:[Object(g.jsx)(j,{show:r,children:Object(g.jsx)(m,{})}),a&&Object(g.jsxs)(u.a.Fragment,{children:[Object(g.jsx)("p",{children:a}),Object(g.jsx)(qe.a,{variant:"contained",onClick:function(){return o(!1)},children:"Log Out"})]}),Object(g.jsx)(tt,{})]}):Object(g.jsx)(u.a.Fragment,{children:Object(g.jsx)("a",{className:O.a.Anchor,href:Ae,children:"LOG IN WITH SPOTIFY"})})]})},rt=n(62);n(98);var at=function(){return Object(g.jsx)("div",{className:d.a.App,children:Object(g.jsx)(rt.a,{children:Object(g.jsx)(nt,{})})})},ct=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,119)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};l.a.render(Object(g.jsx)(E.a,{store:he,children:Object(g.jsx)(u.a.StrictMode,{children:Object(g.jsx)(at,{})})}),document.getElementById("root")),ct()},30:function(e,t,n){e.exports={UserImage:"Main_UserImage__3qxFL"}},34:function(e,t,n){e.exports={ContainerAbsolute:"Layout_ContainerAbsolute__GVuZd",Container:"Layout_Container__BQf6m",Loader:"Layout_Loader__1uyud",Logo:"Layout_Logo__1vjZI",Anchor:"Layout_Anchor__16oze"}},35:function(e,t,n){e.exports={TitleBar:"UserTopData_TitleBar__3Y7Do"}},52:function(e,t,n){e.exports={App:"App_App__1B3w2",Anchor:"App_Anchor__1EPTJ",Logo:"App_Logo__TfFJ9"}},54:function(e,t,n){e.exports={Backdrop:"Backdrop_Backdrop__3Q11w"}},55:function(e,t,n){e.exports={Loader:"Spinner_Loader__3GTOq",spinner:"Spinner_spinner__s3qqN"}},71:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.b230c0ad.chunk.js.map